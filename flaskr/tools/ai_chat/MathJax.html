<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Markdown and LaTeX Render</title>
  <!-- Include Marked for Markdown parsing -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <!-- Configure MathJax for LaTeX rendering using $ delimiters -->
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$']],
        displayMath: [['$$', '$$']]
      },
      svg: {
        fontCache: 'global'
      }
    };
  </script>
  <!-- Include MathJax -->
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      line-height: 1.6;
    }
  </style>
</head>

<body>
  <!-- Container for the rendered Markdown -->
  <div id="content"></div>

  <script>
    // Disable mangling so that any needed backslashes remain intact.
    marked.setOptions({
      mangle: false
    });

    // Markdown content using $ for inline math and $$ for display math.
    const txt1 = `
To find the value of $x$ that satisfies the equation $3x + 4x = 5$, follow these steps:

1. **Combine like terms:**

$$
3x + 4x = 7x
$$

So, the equation becomes:

$$
7x = 5
$$

2. **Solve for $x$:**

To isolate $x$, divide both sides of the equation by 7:

$$
x = \\frac{5}{7}
$$

**Final Answer:**

$$
\\boxed{\\dfrac{5}{7}}
$$
    `;

    const txt = '\n\nTo find the value of \\( x \\) that satisfies equation \\( 3x + 4x = 5 \\), follow these steps:\n\n1.**Combine like terms:**\n   \n   \\[\n   3x + 4x = 7x\n   \\]\n   \n   So, the equation becomes:\n   \n   \\[\n   7x = 5\n   \\]\n\n2. **Solve for \\( x \\):**\n   \n   To isolate \\( x \\), divide both sides of the equation by 7:\n   \n   \\[\n   x = \\frac{5}{7}\n   \\]\n\n**Final Answer:**\n\n\\[\n\\boxed{\\dfrac{5}{7}}\n\\]';

    // Step 1: Replace inline math delimiters:
    // Replace "\(" with "$" and "\)" with "$".
    let new_txt = txt
      .replace(/\\\(/g, '$')
      .replace(/\\\)/g, '$');

    // Step 2: Replace display math delimiters:
    // Replace "\[" with "$$" and "\]" with "$$".
    new_txt = new_txt
      .replace(/\\\[/g, '$$')
      .replace(/\\\]/g, '$$');

    // Step 3: (Optional) Fix list formattingâ€”insert a space after a digit followed by a period if missing.
    new_txt = new_txt.replace(/(\d+)\.(\S)/g, '$1. $2');

    // (Optional) Step 4: Trim extra whitespace inside math delimiters.
    // For inline math ($ ... $):
    new_txt = new_txt.replace(/(?<!\$)\$([\s\S]*?)\$(?!\$)/g, (match, p1) => {
      return '$' + p1.trim() + '$';
    });
    // For display math ($$ ... $$):
    new_txt = new_txt.replace(/\$\$([\s\S]*?)\$\$/g, (match, p1) => {
      return '$$' + p1.trim() + '$$';
    });

    // Now, new_txt contains the converted content. For example:
    console.log(new_txt);

    // Convert Markdown to HTML
    const contentHtml = marked.parse(new_txt);
    document.getElementById('content').innerHTML = contentHtml;

    // Trigger MathJax to process the math in the inserted HTML
    MathJax.typesetPromise();
  </script>
</body>

</html>
